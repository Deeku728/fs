<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Birth Registration - Digital E Gram Panchayat</title>
    <link rel="stylesheet" href="../static/port.css">

  
</head>

<body>
    <div class="container">
        <h2>Birth Registration Form</h2>
        <form id="birthRegistrationForm">
            <label for="childName">Child's Name</label>
            <input type="text" id="childName" placeholder="Enter child's name" required>

            <label for="dateOfBirth">Date of Birth</label>
            <input type="date" id="dateOfBirth" required>

            <label for="gender">Gender</label>
            <select id="gender" required>
                <option value="">-- Select Gender --</option>
                <option value="Male">Male</option>
                <option value="Female">Female</option>
                <option value="Other">Other</option>
            </select>

            <label for="MotherName">Father Name</label>
            <input type="text" id="MotherName" placeholder="Enter parent's names" required>
            <label for="FatherName">Mother Name</label>
            <input type="text" id="FatherName" placeholder="Enter parent's names" required>

            <label for="placeOfBirth">Place of Birth</label>
            <input type="text" id="placeOfBirth" placeholder="Enter place of birth" required>

            <label for="address">Address</label>
            <textarea id="address" placeholder="Enter residential address" required></textarea>

            <button type="submit" class="btn">Submit Registration</button>
        </form>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-app.js";
        import { getDatabase, ref, set } from "https://www.gstatic.com/firebasejs/10.14.0/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCVwyQ6nlGzFcO9DMYGWRADLeGjCFxqOl0",
            authDomain: "e-gram-2da6d.firebaseapp.com",
            projectId: "e-gram-2da6d",
            storageBucket: "e-gram-2da6d.appspot.com",
            messagingSenderId: "406178850869",
            appId: "1:406178850869:web:cbecc9674508f7909be97c",
            databaseURL: "https://e-gram-2da6d-default-rtdb.firebaseio.com/", 
        };

        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);

        document.getElementById('birthRegistrationForm').addEventListener('submit', function (e) {
            e.preventDefault();

            const childName = document.getElementById('childName').value;
            const dateOfBirth = document.getElementById('dateOfBirth').value;
            const gender = document.getElementById('gender').value;
            const MotherName = document.getElementById('MotherName').value;
            const FatherName = document.getElementById('FatherName').value;
            const placeOfBirth = document.getElementById('placeOfBirth').value;
            const address = document.getElementById('address').value;

            const userId = "USER_ID";
            const applicationNumber = generateApplicationNumber(); 

            const birthRegRef = ref(database, 'applications/' + userId + '/birthregistrations/' + applicationNumber);
            set(birthRegRef, {
                childName: childName,
                dateOfBirth: dateOfBirth,
                gender: gender,
                MotherName: MotherName,
                FatherName: FatherName,
                placeOfBirth: placeOfBirth,
                address: address,
                status: 'submitted',
                applicationNumber: applicationNumber
            })
                .then(() => {
                    alert('Birth registration submitted successfully! Your application number is: ' + applicationNumber);
          
                    window.location.href = `status.html?applicationNumber=${applicationNumber}`;
                })
                .catch((error) => {
                    alert('Failed to submit birth registration: ' + error.message);
                });

            function generateApplicationNumber() {
                return 'APP-' + Date.now(); 
            }
        });
    </script>
</body>

</html>